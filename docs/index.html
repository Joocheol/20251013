<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>20251013 포트폴리오 분석 대시보드</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js" defer></script>
    <style>
      :root {
        color-scheme: light dark;
        --bg: linear-gradient(180deg, #eff6ff 0%, #ffffff 100%);
        --card: #ffffffcc;
        --text: #1f2328;
        --muted: #6b7280;
        --accent: #2563eb;
        --shadow: rgba(15, 23, 42, 0.08);
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI',
          sans-serif;
      }
      body {
        margin: 0;
        background: var(--bg);
        color: var(--text);
      }
      header {
        padding: 3.5rem 1.5rem 2.5rem;
        text-align: center;
      }
      header h1 {
        margin: 0;
        font-size: clamp(2rem, 3vw + 1rem, 3.25rem);
        font-weight: 700;
      }
      header p {
        margin: 0.5rem auto 0;
        max-width: 720px;
        font-size: 1.05rem;
        color: var(--muted);
        line-height: 1.6;
      }
      main {
        margin: 0 auto 4rem;
        max-width: 1100px;
        padding: 0 1.5rem;
        display: grid;
        gap: 1.5rem;
      }
      section {
        background: var(--card);
        backdrop-filter: blur(8px);
        border-radius: 16px;
        box-shadow: 0 12px 24px var(--shadow);
        padding: 1.75rem 2rem;
      }
      section h2 {
        margin-top: 0;
        font-size: 1.5rem;
        font-weight: 600;
      }
      .grid {
        display: grid;
        gap: 1.5rem;
      }
      .grid.two-columns {
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      }
      .capm-section {
        display: grid;
        gap: 1.75rem;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        align-items: center;
      }
      .capm-diagram {
        width: 100%;
        max-width: 520px;
        margin: 0 auto;
        display: block;
      }
      .capm-caption {
        color: var(--muted);
        font-size: 0.92rem;
        line-height: 1.6;
      }
      ul {
        margin: 0;
        padding-left: 1.2rem;
        line-height: 1.7;
      }
      .chart-container {
        width: 100%;
        height: 520px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1rem;
        font-size: 0.95rem;
      }
      th,
      td {
        padding: 0.5rem 0.65rem;
        text-align: left;
        border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      }
      th {
        font-weight: 600;
        color: var(--muted);
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 0.04em;
      }
      .badge {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.35rem 0.65rem;
        border-radius: 999px;
        font-size: 0.8rem;
        font-weight: 600;
        background: rgba(37, 99, 235, 0.1);
        color: var(--accent);
      }
      footer {
        text-align: center;
        color: var(--muted);
        padding: 1rem 0 2rem;
        font-size: 0.9rem;
      }
      @media (prefers-color-scheme: dark) {
        :root {
          --bg: linear-gradient(180deg, #0f172a 0%, #111827 100%);
          --card: rgba(15, 23, 42, 0.82);
          --text: #e5e7eb;
          --muted: #94a3b8;
          --shadow: rgba(0, 0, 0, 0.35);
        }
        th,
        td {
          border-bottom-color: rgba(148, 163, 184, 0.25);
        }
      }
    </style>
  </head>
  <body>
    <header>
      <span class="badge">2025.10.13 프로젝트 스냅샷</span>
      <h1>삼성전자·애플·엔비디아 데이터 기반 포트폴리오 분석</h1>
      <p>
        `temp.csv` 데이터셋을 정규화하는 분석 스크립트와 효율적 투자선 계산기를 토대로, 세 종목의
        일별 종가 수익률을 활용한 핵심 인사이트를 요약했습니다. 아래 대시보드는 프로젝트에서 구현한
        주요 기능과 효율적 투자선 결과를 한눈에 제공합니다.
      </p>
    </header>
    <main>
      <section class="grid two-columns">
        <div>
          <h2>핵심 산출물</h2>
          <ul>
            <li><strong>analyze_temp_csv.py</strong>: 두 줄 헤더 CSV를 파싱하고 요약 통계를 계산하는 의존성 없는 CLI.</li>
            <li><strong>efficient_frontier.py</strong>: 동일한 파싱 로직을 활용해 일별 종가 수익률 기반 효율적 투자선을 계산.</li>
            <li>두 스크립트 모두 외부 패키지 없이 실행 가능하며, 필요 시 Plotly 기반 웹 대시보드로 확장 가능.</li>
          </ul>
        </div>
        <div>
          <h2>데이터 요약</h2>
          <ul>
            <li>기간: 2023-10-16 ~ 2025-10-10 (516 거래일)</li>
            <li>포함 종목: 삼성전자(005930.KS), 애플(AAPL), 엔비디아(NVDA)</li>
            <li>주요 통계: NVDA가 가장 높은 변동성(최대 +18.72%, 최소 -16.97%)을 기록</li>
            <li>수익률 상관계수: 삼성전자-애플 0.11, 애플-엔비디아 0.37, 삼성전자-엔비디아 0.09</li>
          </ul>
        </div>
      </section>

      <section>
        <h2>CAPM (자본자산가격결정모형) 이해하기</h2>
        <div class="capm-section">
          <div>
            <p>
              CAPM은 시장 전체의 위험과 개별 자산의 체계적 위험(베타)을 연결해 자본 비용을 추정하는 고전적인 모형입니다.
              위험이 없는 이자율(<em>Risk-free</em>)과 시장 위험 프리미엄(<em>Market Risk Premium</em>)에 자산의 베타를 곱해 기대수익을 계산함으로써,
              효율적 투자선에서 선택한 포트폴리오가 시장 대비 적절한 보상을 제공하는지를 평가할 수 있습니다.
            </p>
            <ul>
              <li>기대수익 = Risk-free + β × (시장 기대수익 − Risk-free)</li>
              <li>β &gt; 1: 시장보다 민감한 공격적 자산, β &lt; 1: 방어적 자산</li>
              <li>기울기(시장 위험 프리미엄)는 위험 대비 요구되는 추가 수익을 의미</li>
            </ul>
          </div>
          <figure>
            <svg
              class="capm-diagram"
              viewBox="0 0 640 360"
              role="img"
              aria-labelledby="capm-title capm-desc"
            >
              <title id="capm-title">CAPM SML Diagram</title>
              <desc id="capm-desc">
                기대수익 축과 베타 축으로 구성된 좌표에 위험이 없는 수익률과 시장 포트폴리오를 잇는 증권시장선이 표시되어 있습니다.
              </desc>
              <defs>
                <linearGradient id="smlGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="#60a5fa" />
                  <stop offset="100%" stop-color="#f97316" />
                </linearGradient>
              </defs>
              <rect x="0" y="0" width="640" height="360" rx="18" fill="rgba(37, 99, 235, 0.05)" />
              <g transform="translate(70 300)">
                <line x1="0" y1="0" x2="0" y2="-240" stroke="#1f2937" stroke-width="2" />
                <line x1="0" y1="0" x2="520" y2="0" stroke="#1f2937" stroke-width="2" />
                <text x="-48" y="-200" fill="#1f2937" font-size="16" font-weight="600" transform="rotate(-90 -48 -200)">
                  기대수익 (E[R])
                </text>
                <text x="250" y="40" fill="#1f2937" font-size="16" font-weight="600">β (체계적 위험)</text>
                <line x1="0" y1="-40" x2="520" y2="-200" stroke="url(#smlGradient)" stroke-width="4" />
                <circle cx="0" cy="-40" r="6" fill="#2563eb" />
                <text x="-10" y="-55" fill="#2563eb" font-size="14" font-weight="600">Risk-free</text>
                <circle cx="360" cy="-160" r="7" fill="#f97316" />
                <text x="340" y="-180" fill="#f97316" font-size="14" font-weight="600">시장 포트폴리오</text>
                <line x1="360" y1="-160" x2="360" y2="0" stroke="#94a3b8" stroke-dasharray="6 6" />
                <text x="350" y="20" fill="#64748b" font-size="13">β = 1</text>
                <line x1="200" y1="-120" x2="200" y2="0" stroke="#d1d5db" stroke-dasharray="4 6" />
                <circle cx="200" cy="-120" r="6" fill="#10b981" />
                <text x="170" y="-135" fill="#0f766e" font-size="13" font-weight="600">개별 자산 A</text>
                <text x="180" y="20" fill="#64748b" font-size="13">β = 0.6</text>
              </g>
            </svg>
            <figcaption class="capm-caption">
              증권시장선(SML)은 위험이 없는 수익률에서 시작해 시장 포트폴리오까지 이어집니다. 자산의 베타가 커질수록 요구되는 기대수익이 기울기에 비례해 증가합니다.
            </figcaption>
          </figure>
        </div>
      </section>

      <section>
        <h2>효율적 투자선 시각화</h2>
        <div id="frontier-chart" class="chart-container"></div>
        <p style="color: var(--muted); font-size: 0.9rem;">
          산점도는 모든 장기 비중 조합(격자 해상도 0.02)을 회색 점으로 표시하며, 그중 위험 대비 기대수익이 지배적인 조합을 주황색
          선으로 강조했습니다. 포인트를 클릭하면 해당 포트폴리오의 종목 비중을 확인할 수 있습니다.
        </p>
      </section>

      <section>
        <h2>대표 효율 포트폴리오</h2>
        <p>
          아래 표는 효율적 투자선에서 위험 수준이 낮은 순으로 상위 여섯 개 포트폴리오를 보여줍니다. 수익률은 일별 기대 수익,
          위험은 일별 수익률 표준편차입니다.
        </p>
        <table id="frontier-table">
          <thead>
            <tr>
              <th scope="col">기대수익</th>
              <th scope="col">위험</th>
              <th scope="col">포트폴리오 가중치</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>
    <footer>© 2025 20251013 프로젝트 팀</footer>

    <script>
      async function loadFrontier() {
        const response = await fetch('frontier_data.json');
        if (!response.ok) {
          throw new Error('frontier_data.json 파일을 불러오지 못했습니다.');
        }
        return response.json();
      }

      function formatPercent(value) {
        return (value * 100).toFixed(2) + '%';
      }

      function formatWeights(weights) {
        return Object.entries(weights)
          .map(([ticker, weight]) => `${ticker} ${(weight * 100).toFixed(0)}%`)
          .join(', ');
      }

      function buildTable(frontier) {
        const tbody = document.querySelector('#frontier-table tbody');
        tbody.innerHTML = '';
        frontier.slice(0, 6).forEach((point) => {
          const weights = formatWeights(point.weights);
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${formatPercent(point.expected_return)}</td>
            <td>${formatPercent(point.risk)}</td>
            <td>${weights}</td>
          `;
          tbody.appendChild(row);
        });
      }

      function renderChart(data) {
        const allTrace = {
          x: data.all.map((point) => point.risk),
          y: data.all.map((point) => point.expected_return),
          mode: 'markers',
          type: 'scatter',
          name: '전체 조합',
          marker: { size: 6, color: 'rgba(148, 163, 184, 0.45)' },
          hovertemplate: '위험: %{x:.3%}<br>기대수익: %{y:.3%}<extra></extra>',
        };
        const frontierTrace = {
          x: data.frontier.map((point) => point.risk),
          y: data.frontier.map((point) => point.expected_return),
          mode: 'lines+markers',
          type: 'scatter',
          name: '효율적 투자선',
          marker: { size: 8, color: '#f97316' },
          line: { width: 3, color: '#f97316' },
          hovertemplate:
            '위험: %{x:.3%}<br>기대수익: %{y:.3%}<br><br>%{customdata}<extra></extra>',
          customdata: data.frontier.map((point) =>
            formatWeights(point.weights).replace(/, /g, '<br>')
          ),
        };
        const layout = {
          margin: { l: 60, r: 30, t: 30, b: 60 },
          xaxis: { title: '위험 (표준편차)', tickformat: '.1%', zeroline: false },
          yaxis: { title: '기대수익', tickformat: '.2%', zeroline: false },
          legend: { orientation: 'h', x: 0, y: 1.12 },
          hovermode: 'closest',
          plot_bgcolor: 'rgba(255,255,255,0.0)',
          paper_bgcolor: 'rgba(255,255,255,0.0)',
        };
        Plotly.newPlot('frontier-chart', [allTrace, frontierTrace], layout, {
          responsive: true,
          displaylogo: false,
        });
      }

      document.addEventListener('DOMContentLoaded', async () => {
        try {
          const data = await loadFrontier();
          buildTable(data.frontier);
          renderChart(data);
        } catch (error) {
          console.error(error);
          const container = document.getElementById('frontier-chart');
          container.innerHTML = '<p>효율적 투자선 데이터를 불러오지 못했습니다.</p>';
        }
      });
    </script>
  </body>
</html>
